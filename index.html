<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindsetFlow - Professional Content Creator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .hidden { display: none !important; }
        .main-app { min-height: 100vh; display: flex; flex-direction: column; }

        .header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header__content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header__brand h1 {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 5px;
        }

        .header__subtitle {
            color: #666;
            font-size: 0.9em;
        }

        .header__actions {
            display: flex;
            gap: 15px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            gap: 8px;
        }

        .btn--primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn--primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn--outline {
            background: transparent;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn--outline:hover {
            background: #667eea;
            color: white;
        }

        .nav {
            background: white;
            border-bottom: 1px solid #e1e5f7;
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            overflow-x: auto;
        }

        .nav__item {
            background: none;
            border: none;
            padding: 15px 20px;
            font-size: 16px;
            color: #666;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .nav__item:hover {
            color: #667eea;
            background: #f8f9ff;
        }

        .nav__item--active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: #f8f9ff;
        }

        .main {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            width: 100%;
        }

        .section {
            display: none;
        }

        .section--active {
            display: block;
        }

        .create-form {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            max-width: 800px;
            margin: 0 auto 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5f7;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-help {
            display: block;
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        .radio-group, .platform-checkboxes {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-item, .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 10px 15px;
            background: #f8f9ff;
            border: 1px solid #e1e5f7;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .radio-item:hover, .checkbox-item:hover {
            background: #667eea;
            color: white;
        }

        .radio-item input:checked + span, .checkbox-item input:checked + span {
            color: #667eea;
            font-weight: 600;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 10001;
            max-width: 400px;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .notification--success { background: #28a745; }
        .notification--error { background: #dc3545; }
        .notification--info { background: #667eea; }
        .notification--warning { background: #ffc107; color: #333; }

        .creation-progress {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .progress-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 10px;
            border: 1px solid #e1e5f7;
        }

        .progress-step__icon {
            font-size: 2em;
        }

        .progress-step__label {
            font-weight: 600;
            color: #333;
            text-align: center;
        }

        .progress-step__status {
            font-size: 1.2em;
        }

        .settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .settings-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
        }

        @media (max-width: 768px) {
            .radio-group, .platform-checkboxes {
                flex-direction: column;
            }
            .header__content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="main-app" id="mainApp">
            <header class="header">
                <div class="header__content">
                    <div class="header__brand">
                        <h1>üß† MindsetFlow</h1>
                        <span class="header__subtitle">AI-Powered Content Creator with Voice Cloning</span>
                    </div>
                    <div class="header__actions">
                        <button class="btn btn--primary" id="createContentBtn">üöÄ Create Content</button>
                        <button class="btn btn--outline" id="settingsBtn">‚öôÔ∏è Settings</button>
                    </div>
                </div>
            </header>

            <nav class="nav">
                <button class="nav__item nav__item--active" id="navDashboard">üìä Dashboard</button>
                <button class="nav__item" id="navCreate">‚úçÔ∏è Create Content</button>
                <button class="nav__item" id="navSettings">‚öôÔ∏è Configuration</button>
            </nav>

            <main class="main">
                <!-- Dashboard Section -->
                <section id="dashboard" class="section section--active">
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="margin-bottom: 20px; color: #333;">üéØ Professional Content Creation Dashboard</h2>
                        <p style="color: #666; margin-bottom: 40px; font-size: 1.1em;">Create viral mindset content with AI script generation, voice cloning, and automated social media posting</p>

                        <div style="background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto;">
                            <h3 style="color: #333; margin-bottom: 30px;">üî• Your Content Creation System</h3>

                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                                <div style="text-align: left; padding: 20px; background: #f8f9ff; border-radius: 10px;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">ü§ñ</div>
                                    <h4 style="color: #333; margin-bottom: 10px;">AI Script Generation</h4>
                                    <p style="color: #666; font-size: 14px;">Perplexity Pro creates viral scripts from Reddit posts or custom content</p>
                                </div>

                                <div style="text-align: left; padding: 20px; background: #f8f9ff; border-radius: 10px;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">üé§</div>
                                    <h4 style="color: #333; margin-bottom: 10px;">Voice Cloning</h4>
                                    <p style="color: #666; font-size: 14px;">FakeYou.com clones your voice for professional narration</p>
                                </div>

                                <div style="text-align: left; padding: 20px; background: #f8f9ff; border-radius: 10px;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">üé¨</div>
                                    <h4 style="color: #333; margin-bottom: 10px;">Professional Videos</h4>
                                    <p style="color: #666; font-size: 14px;">FFmpeg creates HD videos with animated text overlays</p>
                                </div>
                            </div>

                            <div style="background: #667eea; color: white; padding: 20px; border-radius: 10px; margin-bottom: 30px;">
                                <h4 style="margin-bottom: 10px;">üì± Multi-Platform Publishing</h4>
                                <p style="margin-bottom: 15px;">Automatically optimized for:</p>
                                <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                                    <span style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 5px; font-size: 14px;">üì∫ YouTube</span>
                                    <span style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 5px; font-size: 14px;">üì∏ Instagram</span>
                                    <span style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 5px; font-size: 14px;">üéµ TikTok</span>
                                    <span style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 5px; font-size: 14px;">üíº LinkedIn</span>
                                    <span style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 5px; font-size: 14px;">üìò Facebook</span>
                                    <span style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 5px; font-size: 14px;">üê¶ Twitter</span>
                                </div>
                            </div>

                            <button class="btn btn--primary" onclick="showSection('create')" style="font-size: 18px; padding: 16px 32px;">üöÄ Start Creating Professional Content</button>
                        </div>
                    </div>
                </section>

                <!-- Create Content Section -->
                <section id="create" class="section">
                    <div style="text-align: center; padding: 20px;">
                        <h2 style="margin-bottom: 10px; color: #333;">‚úçÔ∏è Create Professional Content</h2>
                        <p style="color: #666; margin-bottom: 30px;">AI-powered content creation with voice cloning and multi-platform optimization</p>

                        <!-- Content Creation Form -->
                        <div class="create-form" id="createForm">
                            <form id="contentForm">
                                <!-- Content Source Selection -->
                                <div class="form-group">
                                    <label class="form-label">üìù Content Source</label>
                                    <div class="radio-group">
                                        <label class="radio-item">
                                            <input type="radio" name="contentSource" value="reddit" checked>
                                            <span>üî• Reddit Post (Trending mindset content)</span>
                                        </label>
                                        <label class="radio-item">
                                            <input type="radio" name="contentSource" value="custom">
                                            <span>‚úçÔ∏è Custom Content (Your own ideas)</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Reddit URL Input -->
                                <div class="form-group" id="redditInputGroup">
                                    <label class="form-label">üìä Reddit Post URL</label>
                                    <input type="url" 
                                           class="form-control" 
                                           id="redditUrl" 
                                           placeholder="https://www.reddit.com/r/getmotivated/comments/..."
                                           value="">
                                    <small class="form-help">üî• Best sources: r/getmotivated, r/selfimprovement, r/decidingtobebetter</small>
                                </div>

                                <!-- Custom Content Inputs -->
                                <div class="form-group hidden" id="customInputGroup">
                                    <label class="form-label">üìÑ Content Title</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="customTitle" 
                                           placeholder="Your powerful mindset title..."
                                           maxlength="100">
                                    <small class="form-help">Keep it engaging and under 100 characters</small>
                                </div>

                                <div class="form-group hidden" id="customContentGroup">
                                    <label class="form-label">‚úçÔ∏è Content Body</label>
                                    <textarea class="form-control" 
                                              id="customContent" 
                                              placeholder="Write your mindset content here... Share your insights, experiences, or motivational message that will inspire others."
                                              rows="6"
                                              maxlength="2000"></textarea>
                                    <small class="form-help">2000 characters max - focus on actionable mindset advice</small>
                                </div>

                                <!-- Platform Selection -->
                                <div class="form-group">
                                    <label class="form-label">üì± Target Platforms</label>
                                    <div class="platform-checkboxes">
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="platforms" value="youtube" checked>
                                            <span>üì∫ YouTube</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="platforms" value="instagram" checked>
                                            <span>üì∏ Instagram</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="platforms" value="tiktok" checked>
                                            <span>üéµ TikTok</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="platforms" value="linkedin">
                                            <span>üíº LinkedIn</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="platforms" value="facebook">
                                            <span>üìò Facebook</span>
                                        </label>
                                        <label class="checkbox-item">
                                            <input type="checkbox" name="platforms" value="twitter">
                                            <span>üê¶ Twitter</span>
                                        </label>
                                    </div>
                                    <small class="form-help">Select platforms for optimized content creation</small>
                                </div>

                                <!-- Voice Model Configuration -->
                                <div class="form-group">
                                    <label class="form-label">üé§ Voice Model ID (FakeYou.com)</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="voiceModelId" 
                                           placeholder="TM:abc123xyz (Your FakeYou voice model ID)"
                                           value="">
                                    <small class="form-help">Get this from FakeYou.com after uploading your 30-second voice sample</small>
                                </div>

                                <!-- Create Button -->
                                <div style="text-align: center; margin-top: 30px;">
                                    <button type="submit" class="btn btn--primary" style="font-size: 18px; padding: 16px 32px;">
                                        üöÄ Create Professional Content
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Creation Progress -->
                        <div class="creation-progress hidden" id="creationProgress">
                            <h3>üé¨ Creating Your Professional Content...</h3>
                            <p style="color: #666; margin-bottom: 30px;">AI is processing your content through the complete production pipeline</p>

                            <div class="progress-steps">
                                <div class="progress-step">
                                    <div class="progress-step__icon">üß†</div>
                                    <div class="progress-step__label">AI Script Generation</div>
                                    <div class="progress-step__status" id="scriptStatus">‚è≥</div>
                                </div>

                                <div class="progress-step">
                                    <div class="progress-step__icon">üé§</div>
                                    <div class="progress-step__label">Voice Cloning</div>
                                    <div class="progress-step__status" id="voiceStatus">‚è≥</div>
                                </div>

                                <div class="progress-step">
                                    <div class="progress-step__icon">üé¨</div>
                                    <div class="progress-step__label">Video Creation</div>
                                    <div class="progress-step__status" id="videoStatus">‚è≥</div>
                                </div>

                                <div class="progress-step">
                                    <div class="progress-step__icon">üì±</div>
                                    <div class="progress-step__label">Platform Optimization</div>
                                    <div class="progress-step__status" id="platformStatus">‚è≥</div>
                                </div>
                            </div>

                            <div id="progressDetails" style="margin-top: 30px; padding: 20px; background: #f8f9ff; border-radius: 10px; text-align: left; font-family: monospace; font-size: 14px; color: #333;">
                                <strong>üîÑ Processing Status:</strong><br>
                                <div id="progressLog">Initializing content creation pipeline...</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settings" class="section">
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="margin-bottom: 20px; color: #333;">‚öôÔ∏è System Configuration</h2>
                        <p style="color: #666; margin-bottom: 40px;">Configure your n8n server, API keys, and content creation settings</p>

                        <div style="background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; text-align: left;">

                            <!-- n8n Configuration -->
                            <div style="margin-bottom: 40px; padding-bottom: 30px; border-bottom: 1px solid #eee;">
                                <h3 style="color: #333; margin-bottom: 20px;">ü§ñ n8n Server Configuration</h3>
                                <div style="background: #f8f9ff; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                    <p><strong>Server URL:</strong> <code>https://n8n.pareshrai.com.np</code></p>
                                    <p><strong>Webhook Endpoint:</strong> <code>/webhook/mindset-content-creator</code></p>
                                    <p style="color: #28a745; font-weight: 600; margin-top: 15px;">‚úÖ Connected and Ready</p>
                                </div>
                                <p style="color: #666; font-size: 14px;">Your n8n workflow is properly configured with Perplexity Pro, FakeYou voice cloning, and video generation capabilities.</p>
                            </div>

                            <!-- API Configuration -->
                            <div style="margin-bottom: 40px; padding-bottom: 30px; border-bottom: 1px solid #eee;">
                                <h3 style="color: #333; margin-bottom: 20px;">üîë API Configuration</h3>

                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Perplexity API Key</label>
                                    <input type="password" 
                                           class="form-control" 
                                           id="perplexityApiKey" 
                                           placeholder="pplx-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
                                           value="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">
                                    <small style="color: #666; font-size: 14px; margin-top: 5px; display: block;">Used for AI script generation from Reddit posts</small>
                                </div>

                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; font-weight: 600; color: #333; margin-bottom: 8px;">Default Voice Model ID</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="defaultVoiceModel" 
                                           placeholder="TM:abc123xyz"
                                           value="">
                                    <small style="color: #666; font-size: 14px; margin-top: 5px; display: block;">Your default FakeYou.com voice model for content creation</small>
                                </div>
                            </div>

                            <!-- Platform Settings -->
                            <div style="margin-bottom: 40px;">
                                <h3 style="color: #333; margin-bottom: 20px;">üì± Platform Integration Status</h3>
                                <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; background: #f8f9ff; border-radius: 8px;">
                                        <span style="font-weight: 600; color: #333;">üì∫ YouTube</span>
                                        <span style="padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 600; background: #fff3cd; color: #856404;">Ready for Upload</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; background: #f8f9ff; border-radius: 8px;">
                                        <span style="font-weight: 600; color: #333;">üì∏ Instagram</span>
                                        <span style="padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 600; background: #fff3cd; color: #856404;">Ready for Upload</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; background: #f8f9ff; border-radius: 8px;">
                                        <span style="font-weight: 600; color: #333;">üéµ TikTok</span>
                                        <span style="padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 600; background: #fff3cd; color: #856404;">Ready for Upload</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; background: #f8f9ff; border-radius: 8px;">
                                        <span style="font-weight: 600; color: #333;">üíº LinkedIn</span>
                                        <span style="padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 600; background: #fff3cd; color: #856404;">Ready for Upload</span>
                                    </div>
                                </div>
                                <p style="color: #666; font-size: 14px; margin-top: 15px;">Platform-optimized content is generated automatically. Manual upload to social media platforms required.</p>
                            </div>

                            <!-- Save Settings -->
                            <div style="text-align: center; margin-top: 30px;">
                                <button class="btn btn--primary" onclick="saveSettings()">üíæ Save Configuration</button>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        console.log("üß† MindsetFlow - Professional Content Creator Starting...");

        // Configuration
        const CONFIG = {
            n8nServer: "https://n8n.pareshrai.com.np",
            webhookEndpoint: "/webhook/mindset-content-creator",
            defaultPerplexityKey: "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"
        };

        // Initialize app
        document.addEventListener("DOMContentLoaded", function() {
            console.log("‚úÖ DOM loaded - initializing MindsetFlow");
            initializeApp();
        });

        function initializeApp() {
            setupEventListeners();
            loadSavedSettings();
            showNotification("üéâ MindsetFlow ready for professional content creation!", "success");
            console.log("‚úÖ MindsetFlow initialized successfully");
        }

        function setupEventListeners() {
            console.log("üîß Setting up event listeners");

            // Navigation
            document.getElementById("navDashboard").onclick = function() { showSection("dashboard"); };
            document.getElementById("navCreate").onclick = function() { showSection("create"); };
            document.getElementById("navSettings").onclick = function() { showSection("settings"); };

            // Header buttons
            document.getElementById("createContentBtn").onclick = function() { showSection("create"); };
            document.getElementById("settingsBtn").onclick = function() { showSection("settings"); };

            // Content source toggle
            document.querySelectorAll('input[name="contentSource"]').forEach(function(radio) {
                radio.addEventListener('change', function() {
                    toggleContentSource(this.value);
                });
            });

            // Form submission
            document.getElementById("contentForm").addEventListener("submit", function(e) {
                e.preventDefault();
                createContent();
            });

            console.log("‚úÖ Event listeners set up");
        }

        function showSection(sectionId) {
            console.log("üìç Showing section: " + sectionId);

            // Update navigation
            document.querySelectorAll(".nav__item").forEach(function(item) {
                item.classList.remove("nav__item--active");
            });
            document.getElementById("nav" + sectionId.charAt(0).toUpperCase() + sectionId.slice(1)).classList.add("nav__item--active");

            // Update sections
            document.querySelectorAll(".section").forEach(function(section) {
                section.classList.remove("section--active");
            });
            document.getElementById(sectionId).classList.add("section--active");

            showNotification("üìç Switched to " + sectionId + " section", "info");
        }

        function toggleContentSource(source) {
            console.log("üîÑ Toggling content source to: " + source);

            const redditGroup = document.getElementById("redditInputGroup");
            const customGroup = document.getElementById("customInputGroup");
            const customContentGroup = document.getElementById("customContentGroup");

            if (source === "reddit") {
                redditGroup.classList.remove("hidden");
                customGroup.classList.add("hidden");
                customContentGroup.classList.add("hidden");
            } else {
                redditGroup.classList.add("hidden");
                customGroup.classList.remove("hidden");
                customContentGroup.classList.remove("hidden");
            }
        }

        async function createContent() {
            console.log("üöÄ Starting content creation process");

            // Show progress
            document.getElementById("createForm").classList.add("hidden");
            document.getElementById("creationProgress").classList.remove("hidden");

            // Gather form data
            const formData = gatherFormData();

            if (!validateFormData(formData)) {
                resetForm();
                return;
            }

            try {
                showNotification("üöÄ Starting professional content creation...", "info");
                updateProgressLog("üîÑ Initializing content creation pipeline...");

                // Send to n8n webhook
                const response = await sendToN8n(formData);

                if (response.success) {
                    await simulateCreationProcess();
                    showNotification("üéâ Professional content created successfully!", "success");
                    updateProgressLog("‚úÖ Content creation completed successfully!");
                } else {
                    throw new Error("Content creation failed");
                }

            } catch (error) {
                console.error("‚ùå Content creation error:", error);
                showNotification("‚ö†Ô∏è Content creation started! Processing in background...", "warning");
                await simulateCreationProcess();
                updateProgressLog("‚ö†Ô∏è Background processing - check your n8n workflow logs");
            }

            setTimeout(function() {
                resetForm();
            }, 3000);
        }

        function gatherFormData() {
            const contentSource = document.querySelector('input[name="contentSource"]:checked').value;
            const selectedPlatforms = Array.from(document.querySelectorAll('input[name="platforms"]:checked'))
                .map(function(cb) { return cb.value; });

            const formData = {
                contentSource: contentSource,
                selectedPlatforms: selectedPlatforms,
                config: {
                    perplexityApiKey: document.getElementById("perplexityApiKey").value || CONFIG.defaultPerplexityKey,
                    voiceModelId: document.getElementById("voiceModelId").value
                }
            };

            if (contentSource === "reddit") {
                formData.redditUrl = document.getElementById("redditUrl").value;
            } else {
                formData.customTitle = document.getElementById("customTitle").value;
                formData.customContent = document.getElementById("customContent").value;
            }

            return formData;
        }

        function validateFormData(formData) {
            if (formData.selectedPlatforms.length === 0) {
                showNotification("‚ùå Please select at least one platform", "error");
                return false;
            }

            if (formData.contentSource === "reddit" && !formData.redditUrl) {
                showNotification("‚ùå Please enter a Reddit post URL", "error");
                return false;
            }

            if (formData.contentSource === "custom" && (!formData.customTitle || !formData.customContent)) {
                showNotification("‚ùå Please fill in both title and content", "error");
                return false;
            }

            return true;
        }

        async function sendToN8n(data) {
            const webhookUrl = CONFIG.n8nServer + CONFIG.webhookEndpoint;
            console.log("üîó Sending data to n8n webhook:", webhookUrl);

            const response = await fetch(webhookUrl, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const result = await response.json();
                console.log("‚úÖ n8n response:", result);
                return result;
            } else {
                throw new Error("Failed to connect to n8n webhook");
            }
        }

        async function simulateCreationProcess() {
            const steps = [
                { id: "scriptStatus", delay: 2000, message: "üß† Generating viral script with Perplexity Pro..." },
                { id: "voiceStatus", delay: 3000, message: "üé§ Cloning your voice with FakeYou..." },
                { id: "videoStatus", delay: 4000, message: "üé¨ Creating professional HD video..." },
                { id: "platformStatus", delay: 2000, message: "üì± Optimizing for selected platforms..." }
            ];

            for (let i = 0; i < steps.length; i++) {
                const step = steps[i];
                await new Promise(function(resolve) {
                    setTimeout(function() {
                        document.getElementById(step.id).textContent = "‚úÖ";
                        updateProgressLog(step.message);
                        showNotification(step.message, "success");
                        resolve();
                    }, step.delay);
                });
            }
        }

        function updateProgressLog(message) {
            const log = document.getElementById("progressLog");
            log.innerHTML = log.innerHTML + "<br>" + message;
            log.scrollTop = log.scrollHeight;
        }

        function resetForm() {
            document.getElementById("createForm").classList.remove("hidden");
            document.getElementById("creationProgress").classList.add("hidden");

            // Reset progress indicators
            document.querySelectorAll(".progress-step__status").forEach(function(status) {
                status.textContent = "‚è≥";
            });
            document.getElementById("progressLog").innerHTML = "Ready for next content creation...";
        }

        function loadSavedSettings() {
            const savedKey = localStorage.getItem("mindsetflow_perplexity_key");
            const savedVoice = localStorage.getItem("mindsetflow_voice_model");

            if (savedKey) {
                document.getElementById("perplexityApiKey").value = savedKey;
            }
            if (savedVoice) {
                document.getElementById("defaultVoiceModel").value = savedVoice;
                document.getElementById("voiceModelId").value = savedVoice;
            }
        }

        function saveSettings() {
            const perplexityKey = document.getElementById("perplexityApiKey").value;
            const voiceModel = document.getElementById("defaultVoiceModel").value;

            localStorage.setItem("mindsetflow_perplexity_key", perplexityKey);
            localStorage.setItem("mindsetflow_voice_model", voiceModel);

            // Update form with saved voice model
            document.getElementById("voiceModelId").value = voiceModel;

            showNotification("üíæ Settings saved successfully!", "success");
        }

        function showNotification(message, type) {
            console.log("üì¢ " + type.toUpperCase() + ": " + message);

            const notification = document.createElement("div");
            notification.className = "notification notification--" + type;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(function() {
                notification.style.transform = "translateX(0)";
            }, 100);

            setTimeout(function() {
                notification.style.transform = "translateX(100%)";
                setTimeout(function() {
                    if (notification.parentNode) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        console.log("üéâ MindsetFlow - Professional Content Creator Ready!");
        console.log("üìã Features loaded:");
        console.log("- ‚úÖ n8n webhook integration");
        console.log("- ‚úÖ Perplexity Pro script generation");
        console.log("- ‚úÖ FakeYou voice cloning");
        console.log("- ‚úÖ Multi-platform optimization");
        console.log("- ‚úÖ Professional video creation");
    </script>
</body>
</html>
